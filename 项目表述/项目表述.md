# 项目表述

## 1、自我介绍

面试官你好，我叫农锦丰，来自广西崇左，目前有3年的Java后端工作经验，上一个小程序项目是“和睦家医疗UnitedFamily”，主要分为两个部分：小程序端和后台管理端，涉及的技术栈有Spring Boot、Redis、Mybatis、Mybatis-Plus、Spring Clound Alibaba、微服务组件Nacos，网关Gateway，远程调用OpenFegin，主要负责的模块是用户端小程序登陆，预约服务，后台订单管理，还有医疗设备的管理。在这个项目开发里面，我最大的收获是医疗设备管理和物联网平台的实现，我的自我介绍就到这里，面试官你有什么想要了解的吗？

> [!tip]
>
> ### 你们的团队有多少人？
>
> 我当时的项目组有10个人左右，4~5个后端，2个前端，1个测试，1个运维，1个产品经理，1个技术主管。
>
> ### 你们公司在哪？
>
> 非洲
>
> ## 技术栈
>
> Spring Boot + Spring Cloud Alibaba + Spring AI + MyBatis-plus + MySQL + Redis + OpenFeign + Gateway + RabbitMQ + Docker + Nginx + （Logback + AOP） + Nacos 
>
> ## 你们项目是一个什么类型的？
>
> B2C

## 2、项目背景

当下，伴随着信息技术的飞速发展，以及公众健康意识高涨，远程医疗、智能硬件和数字疗法成为大健康产业的核心增长点。

在此背景下，我们的项目旨在构建一个符合时代需求的“软硬件一体化”数字健康生态平台。用户可以通过在小程序连接我们的（或者第三方的）智能医疗设备，比如血糖仪、心率监测仪等，为用户提供实时、持久化的健康数据追踪和个性化疗程管理，让用户足不出户就可以对自己的健康有深入的了解。同时，平台整合了在线问诊、健康社区互动和医疗电商服务，满足了用户对专业医疗资源获取、同伴支持交流及便捷购买健康产品的复合型需求。

为支撑该生态的稳定运营，我们打造了强大的BOSS管理后台，实现对设备、疗程、订单、社区及积分体系的精细化、数字化运营，最终目标是打造一个以用户为中心，融合IoT技术、医疗服务和社交电商的闭环健康管理生态系统，积极响应国家“健康中国”战略的数字化浪潮。

## 3、用户，日活，QPS,  TPS

我们项目**总用户数**约2万，**日订单**在500左右，**日活**在3000左右，我们在实际环境中测试的**峰值QPS**在300左右，**TPS在高峰期**大概在0.8-1.2左右，**压测QPS**可以支撑700左右。（总数据，峰值、平均QPS）

高峰请求主要在用户预约，订单流转，订单状态等这些链路。我们通过Redis做热点缓存来保持稳定性。

> [!caution]
>
> 数据量：一千万，不要说两千万，规避分库分表

## 4、技术选型

我们的项目采用前后端分离的微服务架构。前端方面，小程序使用原生微信小程序开发框架，Web管理后台采用Vue3 + ElementPlus构建用户界面，通过Ajax/Axios与后端进行异步数据交互。

后端以Spring Boot为核心框架，结合Spring Cloud Alibaba构建完整的微服务体系。使用Nacos作为注册中心和配置中心实现服务治理，Gateway作为统一网关处理请求路由和权限鉴权，OpenFeign负责服务间的远程调用。数据存储方面选择MySQL作为主数据库存储用户信息、订单数据和设备信息等核心业务数据，Redis用于缓存热点数据和实现分布式锁以提升系统性能。

数据访问层使用MyBatis-Plus简化数据库操作并提供便捷的代码生成和分页查询功能。由于项目涉及智能医疗设备连接，我们对接阿里云OSS实现与血糖仪、心率监测仪等设备的实时数据传输。~~运维部署方面使用Docker进行容器化部署，Nginx作为反向代理和负载均衡保证系统高可用。~~同时通过AOP + Logback实现统一的日志记录和异常监控，~~并集成Spring AI框架为用户提供健康数据分析等智能化服务。~~这套技术栈既保证了系统的稳定性和可扩展性，也满足了医疗健康领域对数据安全和实时性的严格要求。



## 5、流程

用户通过微信打开小程序，点击"微信快捷登录"完成授权——后端通过code获取openid，新用户自动注册并初始化积分。

登录后进入首页，顶部展示健康数据概览，中部是四大功能模块："设备管理"、"微商城"、"健康圈子"和"我的疗程"。

**设备绑定流程**：用户进入"设备管理"，选择"蓝牙搜索"或"扫码绑定"添加设备。绑定成功后，系统建立用户设备关联，通过阿里云SDK接收血糖、心率等数据。当数据异常时，预警系统自动触发提醒。

**购物流程**：用户在"微商城"选择商品并支付，后端订单服务创建"待发货"订单。Web管理后台的订单管理模块显示新订单，管理员审核发货后更新状态为"已发货"并填入物流单号。

**退货流程**：用户在"我的订单"申请退货，后台生成待退货记录。管理员审批通过后，调用支付网关完成退款。

**社区互动**：用户在"健康圈子"发帖分享，图片通过OSS保存，帖子在后台统一审核管理。

**积分体系**：用户完成健康任务（如连续测量）获得积分，后端积分服务通过乐观锁确保积分准确性。

所有个人数据在"我的"页面集中管理，包括设备列表、订单记录、积分明细等，由会员服务提供统一接口支持。整个平台实现了健康监测、电商购物、社区互动的完整闭环，我主要负责用户登录、设备管理、订单处理等核心后端服务。

### 7、详细设计

### 用户登录

我们采用了双token三认证的一个方式来让用户无感登陆，减少了频繁登陆的操作。

我先说一下小程序登陆的大概步骤，首先，前端调用wx.login()获取临时登录凭证code和phoneCode，然后传给后端。后端拿到code后，结合配置的appid和appsecret，调用微信的接口获取用户的openid和session_key（如果用户已授权给同主体其他应用时才返回UnionID）。接着，根据openid查询数据库**判断用户是否已存在**，如果不存在就**创建新用户**并且绑定手机号；如果用户已存在，跳过注册，检查用户是否绑定手机或者更新手机号，后端就会**更新手机号**；获取手机号的步骤大概是这样的：

后端先根据接口（需要grant_type、appid、secret）获取access_token，再根据前端传入的code（phoneCode）和access_token（URL参数）向微信接口发起请求获取手机号。

最后，将用户信息封装到**`Access Token`**和**`Refresh Token`**中，返回给小程序，后续的业务请求都携带这个Access Token（短token）。

对于双token三认证，在刚刚的基础上，我们加了一个单次使用的Refresh Token（长token）来刷新token，用户就可以无感登陆；我们把这个长token存入Redis，并且设置一个24小时的过期时间，当用户的短token过期时，去Redis查询是否存在，如果存在的话，说明已经过期或者被使用，后端就会拒绝刷新令牌操作，强制用户登录。如果还存在的话，我们就刷新短token，并且刷新对应的长token。

> [!note]
>
> 还有其他登陆校验方式：
>
> ​	单点登录SSO（微服务）~~，多因素机制验证MFA，无密码身份验证~~

---

### Redis和JVM缓存

针对首页展示信息、用户疗程列表这些读多写少的场景，我们设计了一个二级缓存架构来优化查询性能。

具体的查询流程是这样的：

首先检查JVM本地缓存（我们使用Caffeine实现），如果命中直接返回数据。

如果JVM缓存没有，再查询Redis分布式缓存，命中的话返回数据并同时写入JVM缓存。

如果Redis也没有，最后查询MySQL数据库，查到数据后同时写入Redis和JVM缓存。

在缓存管理方面，JVM缓存设置了5分钟过期时间，Redis缓存设置30分钟过期。当后台数据发生更新时，会主动清除对应的Redis缓存，JVM缓存则通过TTL自然过期。

---

### 图片上传功能

对接阿里云OSS实现社交圈图片上传功能，前端创建form表单，设置enctype="multipart/form-data"属性，通过input标签选择文件，使用POST方式提交到后端。

后端使用MultipartFile接收文件数据，我会先做一些校验，比如文件大小限制、格式检查（只允许jpg、png等），然后通过配置好的OSS SDK将文件上传到阿里云对象存储。上传成功后，会将文件信息（文件名、大小、URL等）保存到数据库，最后返回文件的访问URL给前端。

这种方案可以更好地做安全控制和业务处理，比如图片压缩、添加水印等。我还配置了上传失败的重试机制，以及文件重复性校验（通过MD5避免重复上传相同文件），保证了系统的稳定性和资源的合理利用。

---

### 阿里云、华为云IoT物联网设备接入

在我们项目中，我负责对接IoT设备管理模块，接入血糖仪、血压计等医疗设备，为用户提供远程健康监测。 技术实现方面，我对接OSS处理设备的注册认证和状态监控。 当设备上报数据时，通过规则引擎进行数据校验和异常告警，比如血糖值异常会自动通知用户。处理后的数据实时推送到小程序，用户可以立即查看监测结果。 我通过Spring Boot集成阿里云IoT SDK，封装了统一的设备管理服务，成功接入了主流家用医疗设备，提升了陪诊服务的专业性。



## 6、在设计开发过程中，有遇到过什么难点和挑战吗？





## 7、项目的亮点是什么？













> [!caution] 
>
> 把面试官当成第一次使用的人
>
> 2~3min，以服务这个为准
>
> 按流程概括性讲，项目背景（市场，解决社会问题 -> 市场调研）-> 负责功能，流程 （微信小程序、登录完之后 -> 医院服务列表）->  详细设计 -> 
>
> 要完整的说完整个流程，避免太散，说得太乱，不用太强调模块。
>
> 不熟悉的不要写
>
> 技术点、细节、数据库设计、为什么要有、接口文档、详细描述、业务流程图、系统时序图、这个点为什么要用线程池（用哪些）、Redis（哪些数据结构）





> [!warning]

> [!tip]

>  [!note]

> [!caution]

> [!important]



### 线程池

...

### 分片下载

线程池





> ## 5、项目整体划分
>
> 小程序端包含有微商城、~~在线咨询~~、~~社交圈~~、IoT设备管理、数据监控、用户疗程、个人中心等这些模块
>
> Web端：订单管理、文档管理，圈子管理，疗程管理以及基础设计等



> - [ ] 在设计开发过程中，有遇到过什么难点和挑战吗？
>
>
> - [ ] 介绍一个解决过的线上问题，是怎么定位问题？怎么解决？采取什么措施避免以后再发生？
>
> - [x] 核心接口的高峰和平均QPS是多少、用户表和订单表有多少数据等指标参数
>
>
> - [ ] 项目的亮点是什么？
>
>
> - [x] 项目组人员组成
>
>
> - [ ] 整个系统总共多少张表？有哪些表？

